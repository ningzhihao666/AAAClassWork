视频内容与互动者

用况：观看并互动视频
参与者：视频消费互动者
简要描述：视频内容互动者能够发现、观看视频内容，对视频进行设置，改变音量、分辨率等，并通过发送弹幕、发布评论、回复别人的评论等多种方式与视频进行互动。

后置条件：视频观看次数、评论等属性改变

事件流：
  基本流：
1.当参与者“视频消费互动者”进入系统并选择主页视频区域时，用况启动。
   {搜索视频}
2. 系统执行子流<加载视频列表>（S1）
{加载视频列表}
3.视频消费互动者从系统展示的视频列表中选择一个公开的视频点击观看。
4.系统执行子流<播放视频>（S2），应用视频的的默认设置（如音量、分辨率）。
 {播放视频}
5.视频消费互动者观看视频内容，系统记录观看进度。
 {观看中}
6.视频播放完毕或者视频消费互动者选择结束当前视频窗口，用况终止。

备选流:
A1 “搜索视频”（普适备选流）
	触发条件：任何时候视频消费互动者在浏览首页视频列表或正在观看视频时，未找到感兴趣的视频，或者有明确目标希望通过搜索快速定位特定视频。
	1.系统响应视频消费互动者的搜索操作，展示搜索页面，包含搜索框和可能的搜索历史记录（如果有）。
        {搜索结果}
	2.视频消费互动者在搜索框中输入想要查找视频的关键词，然后点击搜索按钮。
	3.系统执行子流<根据关键词搜索视频>（S3）
	{执行搜索查询}
	{显示搜索结果}
    4.事件流恢复：事件流恢复到基本流第二步，系统尝试加载视频列表。

A2 “处理视频列表加载失败”（特定备选流）
	扩展点及其触发条件：在{加载视频列表}扩展点上，当系统因为网络错误或者服务异常无法加载视频列表。
	1.系统显示加载失败，请检查网络连接的提示。
	2.系统提供重试的按钮
	3.视频消费互动者点击重试按钮
	4.事件流恢复：事件流恢复到基本流第二步，系统再次尝试加载视频列表。

A3 “处理视频播放错误”（特定备选流）
	扩展点及其触发条件：在{播放视频}扩展点上，当所选视频被删除或者格式不支持等原因导致无法播放
	1.系统提示视频暂时无法播放。
	2.系统自动返回视频列表页面。
	3.浏览首页的公开视频用况终止。

A4 “处理搜索服务异常”（特定备选流）
	扩展点及其触发条件：在 {执行搜索查询} 扩展点上面，当搜索服务不可用（网络不稳定或断网）或者查询出错的时候。
	1.系统在页面上提示“搜索服务暂不可用，请稍后再试”。
	2.搜索内容用况终止。

A5 “处理空搜索结果”（特定备选流）
	扩展点及其触发条件：在 {显示搜索结果} 扩展点上，当系统根据关键词查询之后，没有找到任何匹配的视频。
	1.系统在搜索结果页面显示“视频找不到”的提示。
	2.同时，系统在搜索结果页面显示一些热门视频推荐。
	3.搜索内容的用况终止。

A6 “处理互动 ” （普适备选流）
       触发条件：在{观看中}处的任何时间，当视频消费互动者对视频进行互动时。
        {检查当前用户账户}
        1.系统获取当前用户之前对该视频的互动数据。
      2.系统根据用户互动类型来执行操作：

         a:当用户选择点赞操作时：
            a.1:如果之前用户已经点赞，取消点赞操作; 如果用户没有点赞，视频点赞数加一，显示点赞特效。
            a.2:系统通知当前视频作者被点赞。
            a.3:事件进入到3.

          b:当用户选择收藏操作时：
         b.1：如果当前用户对该视频已经收藏过，取消收藏操作，用户收藏夹取消该视频；如果没有收藏，当前视频的收藏加一，当前用户收藏夹内容添加该视频。
         b.2：事件进入到3

        c:当用户选择投币操作时：
                  {硬币数检查}
        c.1：如果当前用户对该视频已经投币过，无法进行投币操作，如果没有投币，当前视频的投币数加一，用户硬币数量减少。
        c.2：系统将用户投币数给当前视频作者，并提醒作者。
        c.3：事件进入到3

         d：当用户选择缓存操作时：
       d.1：如果当前用户对该已经缓存过，无法进行缓存操作；如果没有缓存，系统获取视频数据，下载视频到用户设备中。
        {下载中}
       d.2：事件进入到3

        e：当用户选择转发操作时：
       e.1:系统获取当前视频的信息，生成视频链接。
       e.2:系统提供窗口用于用户转发链接，用户能够复制当前链接。
       e.3:事件进入到3

      f：当用户选择评论操作时:
      f.1: 系统获取当前视频的信息与评论信息，并且显示 。
     f.2:用户能够输入文字，选择表情，点击发送按钮能够发送评论到当前视频的评论区中。
     f.3:系统获取用户输入的消息，将数据同步到评论区中。
     f.4:事件进入到3

      g：当用户选择回复操作时：
     g.1：系统获取当前视频的信息与评论信息，并且显示 。
      g.2：用户能够输入文字，选择表情，点击发送按钮能够发送回复到当前视频评论的回复区域。
       g.3:系统获取用户输入的消息，将数据同步到评论区中。
       g.4:系统提醒被回复的用户。
      g.5:事件进入到3

     h:当用户选择对评论区的评论或回复点赞操作时：
    h.1：系统获取当前视频的信息与评论信息，并且显示 。
        h.2：用户对评论区中的评论或回复进行点赞，同时系统显示点赞特效。
        h.3：系统获取用户点赞对象，将点赞消息通知给对应用户。
    h.4：事件进入到3

    i：当用户选择对评论区的评论或回复点踩操作时：
  i.1：系统获取当前视频的信息与评论信息，并且显示 。
     i.2用户对评论区中的评论或回复进行点踩，同时系统显示点踩特效。
  i.3：事件进入到3

     3.事件恢复到{观看中}，执行子流<更新系统视频属性>（S4）。

A7“硬币数检查”（普适备选流）
    触发条件：在{硬币数检查}拓展点上，当用户的硬币数量不够的时候。
    1.系统对当前用户显示硬币数量不够的提示。
   2.取消用户的投币操作。
   3.事件恢复到{观看中}。

A8 “下载处理”（普适备选流）
   触发条件：在{下载中}处的任何时间，当网络断开或者不佳的时候。
     1.系统停止下载视频到用户。
     2.系统提示用户因为网络问题下载视频失败。
     3.事件恢复到{观看中}。

A9“下载处理”（普适备选流）
触发条件：在{下载中}处的任何时间，当本地设备存储空间不够的时候。
   1.系统停止下载视频到用户。
   2.系统提示用户存储空间不够，导致视频下载失败。
   3.事件恢复到{观看中}。

A10“账户检查”（特定备选流）
    触发条件：在{检查当前用户账户}拖着点上，当账户被封禁的时候。
    1.系统查询账户详情，获取封禁原因和封禁期限。
    2.系统向用户显示封禁提示信息，包括账户状态、封禁具体原因、封禁期限和解封方式。
    3.系统阻止用户执行任何互动操作（如点赞、评论）。
    4.事件恢复到{观看中}。

子流：
S1 加载视频列表
 1.系统向服务器发送请求，获取各个up主公开的视频列表数据。
 2.服务器返回视频列表数据，系统接收并解析。
 3.系统将解析后的视频列表展示在首页界面。

S2 播放视频
 1.系统获取视频消费互动者点击的视频标识信息。
 2.系统根据该标识信息向服务器请求视频播放数据。
 3.服务器返回视频播放数据，系统接收并在视频播放界面进行播放。
 4.用户点击“倍数，清晰度”。系统立即设置相应的播放。
 5.系统在视频播放界面展示互动功能区

S3 根据关键词搜索视频
   1. 系统将游客输入的关键词发送至服务器。
    2.服务器接收关键词，在视频库中进行搜索匹配。
    3.服务器将搜索结果返回给系统。
    4.系统接收搜索结果并解析。

S4 更新系统视频属性
  1.系统获取当前视频的全部属性，如点赞、评论数量。
  2.系统将当前视频的全部属性覆盖原来视频的属性。
  3.系统更新服务器中的视频数据。